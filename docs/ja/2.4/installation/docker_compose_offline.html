
<!DOCTYPE html>

<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    <title>Docker Compose on Docker - Offline &#8212; Documentation  ドキュメント</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/option.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../_static/exastro_documents.css" />
    <link rel="stylesheet" type="text/css" href="../_static/swagger/swagger-ui.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/tabs.js"></script>
    <script src="../_static/translations.js"></script>
    <script src="../_static/jquery-3.6.3.min.js"></script>
    <script src="../_static/exastro_documents.js"></script>
    <script src="../_static/swagger/swagger-ui-bundle.js"></script>
    <script src="../_static/swagger/swagger-ui-standalone-preset.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="検索" href="../search.html" /> 
  </head>
<body id="page" class="ja">


<div id="container">

<div id="header">
  <header class="divInner">
    <!-- Exastro logo -->
    <div id="logo"><a href="https://ita.exastro.org/"><img src="../_static/img/exastro.svg" alt="Exastro"></a></div>
    <!-- Project name -->
    <div id="projectName"><a href="../index.html">Documentation</a></div>
    <!-- Heaedr navigation -->
    <div id="headerSearch">
      <form class="search" action="../search.html" method="get">
        <input type="text" name="q" aria-labelledby="searchlabel">
        <button type="submit" value="検索"><img src="../_static/img/search.png" alt="検索"></button>
      </form>
    </div>
  </header>
</div><!-- End #header -->


<div id="toolbar">
  <div class="divInner">
    
    <div id="documentVersion">
      <dl>
        <dt>Document version</dt>
        <dd>
          <div>
            <select name="version" onchange="location.href=value;">
              <option value="../../../ja/2.4/installation/docker_compose_offline.html" selected>current</option>
              <option value="../../../ja/2.4/installation/docker_compose_offline.html" selected>2.4(current)</option>
              <option value="../../../ja/2.3/installation/docker_compose_offline.html">2.3</option>
              <option value="../../../ja/2.2/installation/docker_compose_offline.html">2.2</option>
              <option value="../../../ja/2.1/installation/docker_compose_offline.html">2.1</option>
              <option value="../../../ja/2.0/installation/docker_compose_offline.html">2.0</option>
            </select>
          </div>
        </dd>
      </dl>
    </div>

    <div id="documentLanguage">
      <dl>
        <dt>Language</dt>
        <dd>
          <div>
            <select name="lang" onchange="location.href=value;">
              <option value="../../../ja/2.4/installation/docker_compose_offline.html" selected>日本語</option>
              <option value="../../../en/2.4/installation/docker_compose_offline.html">English</option>
            </select>
          </div>
        </dd>
      </dl>
    </div>
    <div id="toolbarNavigation">
      <ul>
      </ul>
    </div>
  </div>
</div><!-- End #toolbar -->

<div id="sideMenu">

  <div id="menuButton"></div>
  
  <aside class="divInner">
    <ul>
<li class="toctree-l1"><a class="reference internal" href="../configuration/index.html">構成・構築ガイド</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html">インストール</a></li>
<li class="toctree-l1"><a class="reference internal" href="../learn/index.html">Learn</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manuals/index.html">マニュアル</a></li>
<li class="toctree-l1"><a class="reference internal" href="../templates/index.html">テンプレート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">リファレンス</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribute/index.html">貢献</a></li>
</ul>

    <!-- <ul>
      <li class="toctree-l1"><a class="reference internal" href="../../../../genindex.html">索引</a></li>
    </ul> -->
    
  </aside>
</div><!-- End #sideMenu -->


<div id="tableOfContents">
  <div id="tocButton"></div>
  <ul>
<li><a class="reference internal" href="#">Docker Compose on Docker - Offline</a><ul>
<li><a class="reference internal" href="#id1">目的</a></li>
<li><a class="reference internal" href="#id2">特徴</a></li>
<li><a class="reference internal" href="#id3">前提条件</a></li>
<li><a class="reference internal" href="#docker-prep">事前準備</a></li>
<li><a class="reference internal" href="#install-docker-compose">全体の流れ</a><ul>
<li><a class="reference internal" href="#id6">オンライン環境での手順</a></li>
<li><a class="reference internal" href="#id7">オフライン環境での手順</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id8">オンライン環境(インターネットに接続できる環境)での作業</a><ul>
<li><a class="reference internal" href="#id9">マウントの設定</a><ul>
<li><a class="reference internal" href="#id10">設定ファイルを開く</a></li>
<li><a class="reference internal" href="#id11">マウント設定を記述する</a></li>
<li><a class="reference internal" href="#id12">設定を反映し、マウントを行う</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id13">コンテナイメージのダウンロード</a><ul>
<li><a class="reference internal" href="#id14">シェルスクリプトを作成する</a></li>
<li><a class="reference internal" href="#id15">シェルスクリプトを実行する</a></li>
</ul>
</li>
<li><a class="reference internal" href="#rpm">RPMパッケージのダウンロード</a><ul>
<li><a class="reference internal" href="#id16">RPMパッケージをダウンロードする</a></li>
</ul>
</li>
<li><a class="reference internal" href="#exastro">Exastroリソースのダウンロード</a><ul>
<li><a class="reference internal" href="#id17">Exastroリソースをダウンロードする</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#id18">オフライン環境(インターネットに接続できない環境)での作業</a><ul>
<li><a class="reference internal" href="#id19">マウントの設定</a><ul>
<li><a class="reference internal" href="#id20">設定ファイルを開く</a></li>
<li><a class="reference internal" href="#id21">マウント設定を記述する</a></li>
<li><a class="reference internal" href="#id22">設定を反映し、マウントを行う</a></li>
</ul>
</li>
<li><a class="reference internal" href="#docker-compose-linux-x86-64">docker-compose-linux-x86_64の取得</a><ul>
<li><a class="reference internal" href="#id23">docker-compose-linux-x86_64を取得する</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id24">RPMパッケージのインストール</a><ul>
<li><a class="reference internal" href="#id25">RPMパッケージを取得する</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id26">コンテナイメージの実行</a><ul>
<li><a class="reference internal" href="#id27">シェルスクリプトを作成する</a></li>
<li><a class="reference internal" href="#id28">シェルスクリプトを実行する</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id29">Exastroリソースのインストール</a><ul>
<li><a class="reference internal" href="#id30">Exastroリソースを取得する</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id31">エラー対応</a><ul>
<li><a class="reference internal" href="#id32">エラー対応</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#id33">ログイン</a></li>
<li><a class="reference internal" href="#id34">オーガナイゼーションの作成</a></li>
<li><a class="reference internal" href="#id35">ワークスペースの作成</a></li>
</ul>
</li>
</ul>

</div>


<div id="contents">
<main class="divInner">

 <div id="breadcrumbs">
  <ul>
    <li><a href="../index.html">HOME</a></li>
    
    <li>Docker Compose on Docker - Offline</li>
  </ul>
</div>

<div id="article">
<article class="divInner">
<div class="body" role="main">

  <script>
$(window).on('load', function () {
   setTimeout(function(){
     for (var i = 0; i < $("table.filter-table").length; i++) {
       $("[id^='ft-data-" + i + "-2-r']").removeAttr("checked");
       $("[id^='select-all-" + i + "-2']").removeAttr("checked");
       $("[id^='ft-data-" + i + "-2-r'][value^='可']").prop('checked', true);
       $("[id^='ft-data-" + i + "-2-r'][value*='必須']").prop('checked', true);
       tFilterGo(i);
     }
   },200);
});
</script><section id="docker-compose-on-docker-offline">
<h1>Docker Compose on Docker - Offline<a class="headerlink" href="#docker-compose-on-docker-offline" title="この見出しへのパーマリンク">¶</a></h1>
<section id="id1">
<h2>目的<a class="headerlink" href="#id1" title="この見出しへのパーマリンク">¶</a></h2>
<div class="line-block">
<div class="line">本書では、Exastro IT Automation を利用する際に必要となる、Exastro Platform および Exastro IT Automation を Docker もしくは Podman 上に導入する手順について説明します。</div>
</div>
</section>
<section id="id2">
<h2>特徴<a class="headerlink" href="#id2" title="この見出しへのパーマリンク">¶</a></h2>
<div class="line-block">
<div class="line">最も簡単に Exastro IT Automation の利用を開始するための導入方法となります。</div>
<div class="line">高い可用性やサービスレベルを必要とする場合には、<a class="reference internal" href="helm_on_kubernetes.html"><span class="doc">Kubernetes 版</span></a> の利用を推奨します。</div>
</div>
</section>
<section id="id3">
<h2>前提条件<a class="headerlink" href="#id3" title="この見出しへのパーマリンク">¶</a></h2>
<div class="line-block">
<div class="line">インターネットに接続できる環境で必要な資材を収集し、記憶媒体等でオフライン環境に持ち込んだ後、インストールを行います。</div>
<div class="line">資材を収集する環境とインストールする環境では、構築状態(OSのバージョン及びインストール済のパッケージ)を一致させる必要があります。</div>
</div>
<ul>
<li><p>デプロイ環境</p>
<div class="line-block">
<div class="line">動作確認が取れているコンテナ環境の最小要求リソースとバージョンは下記のとおりです。</div>
</div>
<table class="docutils align-default" id="id36">
<caption><span class="caption-text">ハードウェア要件(最小構成)</span><a class="headerlink" href="#id36" title="このテーブルへのパーマリンク">¶</a></caption>
<colgroup>
<col style="width: 50.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>リソース種別</p></th>
<th class="head"><p>要求リソース</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>CPU</p></td>
<td><p>2 Cores (3.0 GHz, x86_64)</p></td>
</tr>
<tr class="row-odd"><td><p>Memory</p></td>
<td><p>4GB</p></td>
</tr>
<tr class="row-even"><td><p>Storage (Container image size)</p></td>
<td><p>40GB</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id37">
<caption><span class="caption-text">ハードウェア要件(推奨構成)</span><a class="headerlink" href="#id37" title="このテーブルへのパーマリンク">¶</a></caption>
<colgroup>
<col style="width: 50.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>リソース種別</p></th>
<th class="head"><p>要求リソース</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>CPU</p></td>
<td><p>4 Cores (3.0 GHz, x86_64)</p></td>
</tr>
<tr class="row-odd"><td><p>Memory</p></td>
<td><p>16GB</p></td>
</tr>
<tr class="row-even"><td><p>Storage (Container image size)</p></td>
<td><p>120GB</p></td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<div class="line-block">
<div class="line">最小構成における要求リソースは Exastro IT Automation のコア機能に対する値です。GitLab や Ansible Automation Platform などの外部システムをデプロイする場合は、その分のリソースが別途必要となります。</div>
<div class="line">データベースおよびファイルの永続化のために、別途ストレージ領域を用意する必要があります。</div>
<div class="line">Storage サイズは、ユーザーの利用状況によるためあくまで目安となります。必要に応じて容量を確保してください。</div>
</div>
</div>
</li>
<li><p>通信要件</p>
<table class="docutils align-default" id="id38">
<caption><span class="caption-text">通信要件</span><a class="headerlink" href="#id38" title="このテーブルへのパーマリンク">¶</a></caption>
<colgroup>
<col style="width: 25.0%" />
<col style="width: 33.3%" />
<col style="width: 16.7%" />
<col style="width: 16.7%" />
<col style="width: 8.3%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>用途</p></th>
<th class="head"><p>説明</p></th>
<th class="head"><p>通信元</p></th>
<th class="head"><p>通信先</p></th>
<th class="head"><p>デフォルト</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Exastro サービス用</p></td>
<td><p>Exastro サービスとの接続に利用</p></td>
<td><p>クライアント</p></td>
<td><p>Exastro システム</p></td>
<td><p>30080/tcp</p></td>
</tr>
<tr class="row-odd"><td><p>Exastro システム管理用</p></td>
<td><p>Exastro システム管理機能に利用</p></td>
<td><p>クライアント</p></td>
<td><p>Exastro システム</p></td>
<td><p>30081/tcp</p></td>
</tr>
<tr class="row-even"><td><p>GitLab サービス用(オプション)</p></td>
<td><p>AAP連携時の GitLab サービス接続に利用</p></td>
<td><p>Ansible Automation Platform</p></td>
<td><p>Exastro システム</p></td>
<td><p>40080/tcp</p></td>
</tr>
<tr class="row-odd"><td><p>GitLab サービス用(オプション)</p></td>
<td><p>GitLab サービス監視用</p></td>
<td><p>Exastro システム</p></td>
<td><p>Exastro システム</p></td>
<td><p>40080/tcp</p></td>
</tr>
<tr class="row-even"><td><p>資材取得</p></td>
<td><p>GitHub、コンテナイメージ、導入パッケージなど</p></td>
<td><p>Exastro システム</p></td>
<td><p>インターネット</p></td>
<td><p>443/tcp</p></td>
</tr>
</tbody>
</table>
</li>
<li><p>動作確認済みオペレーティングシステム</p>
<p>以下は、動作確認済のバージョンとなります。</p>
<table class="docutils align-default" id="id39">
<caption><span class="caption-text">オペレーティングシステム</span><a class="headerlink" href="#id39" title="このテーブルへのパーマリンク">¶</a></caption>
<colgroup>
<col style="width: 50.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>種別</p></th>
<th class="head"><p>バージョン</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Red Hat Enterprise Linux</p></td>
<td><p>バージョン    8</p></td>
</tr>
<tr class="row-odd"><td><p>AlmaLinux</p></td>
<td><p>バージョン    8</p></td>
</tr>
<tr class="row-even"><td><p>Ubuntu</p></td>
<td><p>バージョン    22.04</p></td>
</tr>
</tbody>
</table>
</li>
<li><p>動作確認済みコンテナプラットフォーム</p>
<p>手動でインストールする際には、下記のコンテナプラットフォームを準備してください。
以下は、動作確認済のバージョンとなります。</p>
<table class="docutils align-default" id="id40">
<caption><span class="caption-text">コンテナプラットフォーム</span><a class="headerlink" href="#id40" title="このテーブルへのパーマリンク">¶</a></caption>
<colgroup>
<col style="width: 66.7%" />
<col style="width: 33.3%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>ソフトウェア</p></th>
<th class="head"><p>バージョン</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Podman Engine ※Podman 利用時</p></td>
<td><p>バージョン    4.4</p></td>
</tr>
<tr class="row-odd"><td><p>Docker Compose ※Podman 利用時</p></td>
<td><p>バージョン    2.20</p></td>
</tr>
<tr class="row-even"><td><p>Docker Engine ※Docker 利用時</p></td>
<td><p>バージョン    24</p></td>
</tr>
</tbody>
</table>
</li>
<li><p>アプリケーション</p>
<div class="line-block">
<div class="line"><strong class="command">curl</strong> と <strong class="command">sudo</strong> コマンドが実行できる必要があります。</div>
</div>
</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<div class="line-block">
<div class="line">Exastro のプロセスは一般ユーザ権限で起動する必要があります。(rootユーザーでのインストールはできません)</div>
<div class="line">また、利用する一般ユーザは sudoer で、全操作権限を持っている必要があります。</div>
</div>
</div>
</section>
<section id="docker-prep">
<span id="id4"></span><h2>事前準備<a class="headerlink" href="#docker-prep" title="この見出しへのパーマリンク">¶</a></h2>
<div class="line-block">
<div class="line">Exastro の起動にはdocker-composeを使用するため、docker-compose-linux-x86_64を下記URLからダウンロードします。</div>
<div class="line"><a class="reference external" href="https://github.com/docker/compose/releases/download/v2.20.3/docker-compose-linux-x86_64">https://github.com/docker/compose/releases/download/v2.20.3/docker-compose-linux-x86_64</a></div>
<div class="line">サービス公開用の URL を準備しておく必要があります。</div>
</div>
<table class="docutils align-default" id="id41">
<caption><span class="caption-text">例1) IPアドレスによるサービス公開</span><a class="headerlink" href="#id41" title="このテーブルへのパーマリンク">¶</a></caption>
<colgroup>
<col style="width: 42.9%" />
<col style="width: 57.1%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>サービス</p></th>
<th class="head"><p>URL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Exastro サービス</p></td>
<td><p><a class="reference external" href="http://172.16.0.1:30080">http://172.16.0.1:30080</a></p></td>
</tr>
<tr class="row-odd"><td><p>Exastro 管理用サービス</p></td>
<td><p><a class="reference external" href="http://172.16.0.1:30081">http://172.16.0.1:30081</a></p></td>
</tr>
<tr class="row-even"><td><p>GitLab サービス</p></td>
<td><p><a class="reference external" href="http://172.16.0.1:40080">http://172.16.0.1:40080</a></p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id42">
<caption><span class="caption-text">例2) ドメインによるサービス公開</span><a class="headerlink" href="#id42" title="このテーブルへのパーマリンク">¶</a></caption>
<colgroup>
<col style="width: 42.9%" />
<col style="width: 57.1%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>サービス</p></th>
<th class="head"><p>URL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Exastro サービス</p></td>
<td><p><a class="reference external" href="http://ita.example.com:30080">http://ita.example.com:30080</a></p></td>
</tr>
<tr class="row-odd"><td><p>Exastro 管理用サービス</p></td>
<td><p><a class="reference external" href="http://ita.example.com:30081">http://ita.example.com:30081</a></p></td>
</tr>
<tr class="row-even"><td><p>GitLab サービス</p></td>
<td><p><a class="reference external" href="http://ita.example.com:40080">http://ita.example.com:40080</a></p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id43">
<caption><span class="caption-text">例3) LoadBalancer を経由したサービス公開</span><a class="headerlink" href="#id43" title="このテーブルへのパーマリンク">¶</a></caption>
<colgroup>
<col style="width: 42.9%" />
<col style="width: 57.1%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>サービス</p></th>
<th class="head"><p>URL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Exastro サービス</p></td>
<td><p><a class="reference external" href="https://ita.example.com">https://ita.example.com</a></p></td>
</tr>
<tr class="row-odd"><td><p>Exastro 管理用サービス</p></td>
<td><p><a class="reference external" href="https://ita-mng.example.com">https://ita-mng.example.com</a></p></td>
</tr>
<tr class="row-even"><td><p>GitLab サービス</p></td>
<td><p><a class="reference external" href="https://gitlab.example.com">https://gitlab.example.com</a></p></td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<div class="line-block">
<div class="line">HTTPSを利用する場合には、 LoadBalancer または、リバースプロキシを利用する必要があります。</div>
<div class="line">LoadBalancer または、リバースプロキシを利用する場合は、別途準備をする必要があります。</div>
</div>
</div>
</section>
<section id="install-docker-compose">
<span id="id5"></span><h2>全体の流れ<a class="headerlink" href="#install-docker-compose" title="この見出しへのパーマリンク">¶</a></h2>
<div class="line-block">
<div class="line">オンライン環境での作業完了後に、オフライン環境にてインストールを実施します。</div>
</div>
<section id="id6">
<h3>オンライン環境での手順<a class="headerlink" href="#id6" title="この見出しへのパーマリンク">¶</a></h3>
<div class="line-block">
<div class="line">1.マウントの設定</div>
<div class="line">1-1 設定ファイルを開く</div>
<div class="line">1-2 マウント設定を記述する</div>
<div class="line">1-3 設定を反映し、マウントを行う</div>
</div>
<div class="line-block">
<div class="line">2.コンテナイメージのダウンロード</div>
<div class="line">2-1 シェルスクリプトを作成する</div>
<div class="line">2-2 シェルスクリプトを実行する</div>
</div>
<div class="line-block">
<div class="line">3.RPMパッケージのダウンロード</div>
<div class="line">3-1 RPMパッケージをダウンロードする</div>
<div class="line">3-2 createrepoをインストールする</div>
<div class="line">3-3 ローカルリポジトリを作成する</div>
<div class="line">3-4 ダウンロードしたRMPパッケージを格納する</div>
</div>
<div class="line-block">
<div class="line">4.Exastroリソースのダウンロード</div>
<div class="line">4-1 Exastroリソースをダウンロードする</div>
<div class="line">4-2 ダウンロードしたExastroリソースを格納する</div>
</div>
</section>
<section id="id7">
<h3>オフライン環境での手順<a class="headerlink" href="#id7" title="この見出しへのパーマリンク">¶</a></h3>
<div class="line-block">
<div class="line">1.マウントの設定</div>
<div class="line">1-1 設定ファイルを開く</div>
<div class="line">1-2 マウント設定を記述する</div>
<div class="line">1-3 設定を反映し、マウントを行う</div>
</div>
<div class="line-block">
<div class="line">2.docker-compose-linux-x86_64の取得</div>
<div class="line">2-1 docker-compose-linux-x86_64を取得する</div>
</div>
<div class="line-block">
<div class="line">3.RPMパッケージのダウンロード</div>
<div class="line">3-1 RPMパッケージを取得する</div>
<div class="line">3-2 リポジトリファイルを作成する</div>
<div class="line">3-3 リポジトリ情報を記載する</div>
<div class="line">3-4 パッケージをインストールする</div>
<div class="line">3-5 エラー対応</div>
<div class="line">3-5-1 エラーとなったパッケージを削除する</div>
<div class="line">3-5-2 パッケージを再インストールする</div>
</div>
<div class="line-block">
<div class="line">4.コンテナイメージのダウンロード</div>
<div class="line">4-1 シェルスクリプトを作成する</div>
<div class="line">4-2 シェルスクリプトを実行する</div>
</div>
<div class="line-block">
<div class="line">5.Exastroリソースのインストール</div>
<div class="line">5-1 Exastroリソースを取得する</div>
<div class="line">5-2 Exastroリソースをインストールする</div>
<div class="line">5-3 Exastroを起動する</div>
</div>
</section>
</section>
<section id="id8">
<h2>オンライン環境(インターネットに接続できる環境)での作業<a class="headerlink" href="#id8" title="この見出しへのパーマリンク">¶</a></h2>
<div class="line-block">
<div class="line">資材の収集を行います。</div>
<div class="line">ここではNFSにマウントする方法で資材の受け渡しを実施しています。</div>
<div class="line">以下、ユーザーはtestuser、ホームディレクトリは/home/testuserで実行した例です。</div>
</div>
<section id="id9">
<h3>マウントの設定<a class="headerlink" href="#id9" title="この見出しへのパーマリンク">¶</a></h3>
<section id="id10">
<h4>設定ファイルを開く<a class="headerlink" href="#id10" title="この見出しへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">下記を順に実行し、資材受け渡し用のマウント設定を行います。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id44">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id44" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>sudo<span class="w"> </span>su<span class="w"> </span>-
<span class="linenos">2</span>vi<span class="w"> </span>/etc/fstab
</pre></div>
</div>
</div>
</section>
<section id="id11">
<h4>マウント設定を記述する<a class="headerlink" href="#id11" title="この見出しへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">viエディタで開いた/etc/fstabに下記のマウント設定を追記します。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id45">
<div class="code-block-caption"><span class="caption-text">記載例</span><a class="headerlink" href="#id45" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>/dev/sda1<span class="w"> </span>/mnt/mainte<span class="w"> </span>nfs<span class="w"> </span>defaults<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>
</pre></div>
</div>
</div>
</section>
<section id="id12">
<h4>設定を反映し、マウントを行う<a class="headerlink" href="#id12" title="この見出しへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">下記を順に実行し、設定を反映します。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id46">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id46" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>mkdir<span class="w"> </span>/mnt/mainte
<span class="linenos">2</span>systemctl<span class="w"> </span>daemon-reload
<span class="linenos">3</span>mount<span class="w"> </span>-a
<span class="linenos">4</span>df
<span class="linenos">5</span><span class="nb">exit</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="id13">
<h3>コンテナイメージのダウンロード<a class="headerlink" href="#id13" title="この見出しへのパーマリンク">¶</a></h3>
<section id="id14">
<h4>シェルスクリプトを作成する<a class="headerlink" href="#id14" title="この見出しへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">コンテナイメージをダウンロードするシェルスクリプトを作成します。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id47">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id47" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>/mnt/mainte/exastro/container-images
touch<span class="w"> </span>image.list
vi<span class="w"> </span>image.list
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id48">
<div class="code-block-caption"><span class="caption-text">下記のコードをコピー＆ペーストする</span><a class="headerlink" href="#id48" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>docker.io/mariadb:10.9.8
docker.io/mariadb:10.11.4
docker.io/gitlab/gitlab-ce:15.11.13-ce.0
docker.io/mongo:6.0.7
docker.io/exastro/keycloak:#__PF_VERSION__#
docker.io/exastro/exastro-platform-auth:#__PF_VERSION__#
docker.io/exastro/exastro-platform-web:#__PF_VERSION__#
docker.io/exastro/exastro-platform-api:#__PF_VERSION__#
docker.io/exastro/exastro-platform-job:#__PF_VERSION__#
docker.io/exastro/exastro-platform-migration:#__PF_VERSION__#
docker.io/exastro/exastro-platform-migration:#__PF_VERSION__#
docker.io/exastro/exastro-it-automation-api-organization:#__ITA_VERSION__#
docker.io/exastro/exastro-it-automation-api-admin:#__ITA_VERSION__#
docker.io/exastro/exastro-it-automation-api-oase-receiver:#__ITA_VERSION__#
docker.io/exastro/exastro-it-automation-web-server:#__ITA_VERSION__#
docker.io/exastro/exastro-it-automation-by-ansible-agent:#__ITA_VERSION__#
docker.io/exastro/exastro-it-automation-by-ansible-execute:#__ITA_VERSION__#
docker.io/exastro/exastro-it-automation-by-ansible-execute-onpremises:#__ITA_VERSION__#
docker.io/exastro/exastro-it-automation-by-ansible-legacy-role-vars-listup:#__ITA_VERSION__#
docker.io/exastro/exastro-it-automation-by-ansible-legacy-vars-listup:#__ITA_VERSION__#
docker.io/exastro/exastro-it-automation-by-ansible-pioneer-vars-listup:#__ITA_VERSION__#
docker.io/exastro/exastro-it-automation-by-ansible-towermaster-sync:#__ITA_VERSION__#
docker.io/exastro/exastro-it-automation-by-collector:#__ITA_VERSION__#
docker.io/exastro/exastro-it-automation-by-conductor-synchronize:#__ITA_VERSION__#
docker.io/exastro/exastro-it-automation-by-conductor-regularly:#__ITA_VERSION__#
docker.io/exastro/exastro-it-automation-by-menu-create:#__ITA_VERSION__#
docker.io/exastro/exastro-it-automation-by-menu-export-import:#__ITA_VERSION__#
docker.io/exastro/exastro-it-automation-by-excel-export-import:#__ITA_VERSION__#
docker.io/exastro/exastro-it-automation-by-terraform-cloud-ep-execute:#__ITA_VERSION__#
docker.io/exastro/exastro-it-automation-by-terraform-cloud-ep-vars-listup:#__ITA_VERSION__#
docker.io/exastro/exastro-it-automation-by-terraform-cli-execute:#__ITA_VERSION__#
docker.io/exastro/exastro-it-automation-by-terraform-cli-vars-listup:#__ITA_VERSION__#
docker.io/exastro/exastro-it-automation-by-hostgroup-split:#__ITA_VERSION__#
docker.io/exastro/exastro-it-automation-by-cicd-for-iac:#__ITA_VERSION__#
docker.io/exastro/exastro-it-automation-by-oase-conclusion:#__ITA_VERSION__#
docker.io/exastro/exastro-it-automation-by-execinstance-dataautoclean:#__ITA_VERSION__#
docker.io/exastro/exastro-it-automation-by-file-autoclean:#__ITA_VERSION__#
docker.io/exastro/exastro-it-automation-migration:#__ITA_VERSION__#
docker.io/exastro/exastro-it-automation-by-ansible-agent:#__ITA_VERSION__#
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id49">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id49" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>touch<span class="w"> </span>save.sh
vi<span class="w"> </span>save.sh
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id50">
<div class="code-block-caption"><span class="caption-text">下記のコードをコピー＆ペーストする</span><a class="headerlink" href="#id50" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="nv">ITA_VERSION</span><span class="o">=</span><span class="nv">$1</span>
<span class="nb">declare</span><span class="w"> </span>-A<span class="w"> </span><span class="nv">PF_VERSION</span><span class="o">=(</span>
<span class="w">  </span><span class="o">[</span><span class="s2">&quot;2.2.0&quot;</span><span class="o">]=</span><span class="s2">&quot;1.6.0&quot;</span>
<span class="w">  </span><span class="o">[</span><span class="s2">&quot;2.2.1&quot;</span><span class="o">]=</span><span class="s2">&quot;1.6.0&quot;</span>
<span class="w">  </span><span class="o">[</span><span class="s2">&quot;2.3.0&quot;</span><span class="o">]=</span><span class="s2">&quot;1.7.0&quot;</span>
<span class="w">  </span><span class="o">[</span><span class="s2">&quot;2.4.0&quot;</span><span class="o">]=</span><span class="s2">&quot;1.8.0&quot;</span>
<span class="w">  </span><span class="o">[</span><span class="s2">&quot;alpha.2499a9.20240328-232349&quot;</span><span class="o">]=</span><span class="s2">&quot;alpha.d718ac.20240325-152726&quot;</span>
<span class="w">  </span><span class="o">[</span><span class="s2">&quot;alpha.545f6a.20240403-232818&quot;</span><span class="o">]=</span><span class="s2">&quot;alpha.d718ac.20240325-152726&quot;</span>
<span class="w">  </span><span class="o">[</span><span class="s2">&quot;alpha.03f9ca.20240406-214252&quot;</span><span class="o">]=</span><span class="s2">&quot;alpha.d718ac.20240325-152726&quot;</span>
<span class="o">)</span>
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>!<span class="w"> </span>-d<span class="w"> </span><span class="nv">$1</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">  </span>mkdir<span class="w"> </span><span class="nv">$ITA_VERSION</span>
<span class="k">fi</span>

readarray<span class="w"> </span>-t<span class="w"> </span>image_list<span class="w"> </span>&lt;<span class="w"> </span><span class="s2">&quot;./image.list&quot;</span>
<span class="k">for</span><span class="w"> </span>image<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="si">${</span><span class="nv">image_list</span><span class="p">[@]</span><span class="si">}</span>
<span class="k">do</span>
<span class="w">  </span><span class="nv">image_fullname</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span><span class="w"> </span><span class="si">${</span><span class="nv">image</span><span class="si">}</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;s/#__ITA_VERSION__#/</span><span class="si">${</span><span class="nv">ITA_VERSION</span><span class="si">}</span><span class="s2">/&quot;</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;s/#__PF_VERSION__#/</span><span class="si">${</span><span class="nv">PF_VERSION</span><span class="p">[</span><span class="nv">$ITA_VERSION</span><span class="p">]</span><span class="si">}</span><span class="s2">/&quot;</span><span class="k">)</span>
<span class="w">  </span><span class="nv">image_name</span><span class="o">=</span><span class="k">$(</span>basename<span class="w"> </span><span class="si">${</span><span class="nv">image_fullname</span><span class="si">}</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;s/:/-/&quot;</span><span class="k">)</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>!<span class="w"> </span>-e<span class="w"> </span><span class="si">${</span><span class="nv">ITA_VERSION</span><span class="si">}</span>/<span class="si">${</span><span class="nv">image_name</span><span class="si">}</span>.tar.gz<span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$image_fullname</span><span class="w"> </span><span class="nv">$image_name</span>
<span class="w">    </span>docker<span class="w"> </span>pull<span class="w"> </span><span class="si">${</span><span class="nv">image_fullname</span><span class="si">}</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$?</span><span class="w"> </span>-eq<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">      </span>docker<span class="w"> </span>save<span class="w"> </span><span class="si">${</span><span class="nv">image_fullname</span><span class="si">}</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>gzip<span class="w"> </span>-c<span class="w"> </span>&gt;<span class="w"> </span><span class="si">${</span><span class="nv">ITA_VERSION</span><span class="si">}</span>/<span class="si">${</span><span class="nv">image_name</span><span class="si">}</span>.tar.gz
<span class="w">    </span><span class="k">fi</span>
<span class="w">  </span><span class="k">fi</span>
<span class="k">done</span>
</pre></div>
</div>
</div>
</section>
<section id="id15">
<h4>シェルスクリプトを実行する<a class="headerlink" href="#id15" title="この見出しへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">シェルスクリプトを実行しコンテナイメージをダウンロードします。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id51">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id51" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sh<span class="w"> </span>./save.sh<span class="w"> </span><span class="m">2</span>.4.0
</pre></div>
</div>
</div>
</section>
</section>
<section id="rpm">
<h3>RPMパッケージのダウンロード<a class="headerlink" href="#rpm" title="この見出しへのパーマリンク">¶</a></h3>
<section id="id16">
<h4>RPMパッケージをダウンロードする<a class="headerlink" href="#id16" title="この見出しへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">パッケージをダウンロードします。</div>
</div>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-ZG9ja2Vy" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-0-ZG9ja2Vy" name="ZG9ja2Vy" role="tab" tabindex="0">docker</button><button aria-controls="panel-0-cG9kbWFu" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-0-cG9kbWFu" name="cG9kbWFu" role="tab" tabindex="-1">podman</button></div><div aria-labelledby="tab-0-ZG9ja2Vy" class="sphinx-tabs-panel group-tab" id="panel-0-ZG9ja2Vy" name="ZG9ja2Vy" role="tabpanel" tabindex="0"><div class="line-block">
<div class="line">ダウンロード先ディレクトリを/tmp/docker-repo-almalinux、インストール先ディレクトリを/tmp/docker-installroot-almalinuxとしています。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id52">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id52" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--downloadonly<span class="w"> </span>--downloaddir<span class="o">=</span>/tmp/docker-repo-almalinux<span class="w"> </span>--installroot<span class="o">=</span>/tmp/docker-installroot-almalinux<span class="w"> </span>--releasever<span class="o">=</span><span class="m">8</span>.9<span class="w"> </span>git
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<div class="line-block">
<div class="line">各オプションの説明</div>
</div>
<div class="line-block">
<div class="line">=--downloadonly</div>
<div class="line">パッケージをインストールせずにダウンロードのみ行います。</div>
<div class="line">オフライン環境で使用するためのパッケージのダウンロードのみ行うため、インストールは不要です。</div>
</div>
<div class="line-block">
<div class="line">--downloaddir=&lt;ダウンロード先パス&gt;</div>
<div class="line">パッケージをダウンロードするディレクトリを指定します。</div>
<div class="line">通常のダウンロードと同様に、ローカルにあるパッケージと依存関係を解決しつつダウンロードされるため、</div>
<div class="line">該当パッケージがすでにインストールされている場合は不足分のみダウンロードされます。</div>
</div>
<div class="line-block">
<div class="line">--installroot=&lt;ダウンロード先絶対パス&gt;</div>
<div class="line">通常とは別の場所へインストールするために利用します。</div>
<div class="line">インストール済みのパッケージも含めてすべてダウンロードするため</div>
<div class="line">ダミーディレクトリを指定し、すべての パッケージをダウンロードします。</div>
</div>
<div class="line-block">
<div class="line">--releasever=&lt;バージョン&gt;</div>
<div class="line">ディストリビューションのバージョンを指定(8.9など)します。</div>
</div>
</div>
<div class="line-block">
<div class="line">createrepoをインストールします。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id53">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id53" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>createrepo
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">ローカルリポジトリを作成します。</div>
<div class="line">オフライン環境ではインターネット上のリポジトリサーバーを参照できないため、dnfによるパッケージのインストールができません。</div>
<div class="line">ローカルリポジトリにパッケージを追加することで、dnfによるパッケージインストールが可能となります。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id54">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id54" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>createrepo<span class="w"> </span>/tmp/docker-repo-almalinux
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">RPMパッケージを受け渡し用のディレクトリに格納します。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id55">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id55" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="nb">cd</span><span class="w"> </span>/tmp
<span class="linenos">2</span>cp<span class="w"> </span>-irp<span class="w"> </span>/tmp/docker-repo-almalinux<span class="w"> </span>&lt;受け渡し用ディレクトリ&gt;
<span class="linenos">3</span><span class="c1">#/mnt/mainte/exastro/almalinux/dockerを受け渡し用ディレクトリとする場合</span>
<span class="linenos">4</span>cp<span class="w"> </span>-irp<span class="w"> </span>/tmp/docker-repo-almalinux<span class="w"> </span>/mnt/mainte/exastro/almalinux/docker
</pre></div>
</div>
</div>
</div><div aria-labelledby="tab-0-cG9kbWFu" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-0-cG9kbWFu" name="cG9kbWFu" role="tabpanel" tabindex="0"><div class="line-block">
<div class="line">ダウンロード先ディレクトリを/tmp/podman-repo、インストール先ディレクトリを/tmp/podman-installrootとしています。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id56">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id56" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--downloadonly<span class="w"> </span>--downloaddir<span class="o">=</span>/tmp/podman-repo<span class="w"> </span>--installroot<span class="o">=</span>/tmp/podman-installroot<span class="w"> </span>--releasever<span class="o">=</span><span class="m">9</span>.4<span class="w"> </span>git
sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--downloadonly<span class="w"> </span>--downloaddir<span class="o">=</span>/tmp/podman-repo<span class="w"> </span>--installroot<span class="o">=</span>/tmp/podman-installroot<span class="w"> </span>--releasever<span class="o">=</span><span class="m">9</span>.4<span class="w"> </span>podman
sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--downloadonly<span class="w"> </span>--downloaddir<span class="o">=</span>/tmp/podman-repo<span class="w"> </span>--installroot<span class="o">=</span>/tmp/podman-installroot<span class="w"> </span>--releasever<span class="o">=</span><span class="m">9</span>.4<span class="w"> </span>podman-docker
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<div class="line-block">
<div class="line">各オプションの説明</div>
</div>
<div class="line-block">
<div class="line">=--downloadonly</div>
<div class="line">パッケージをインストールせずにダウンロードのみ行います。</div>
<div class="line">オフライン環境で使用するためのパッケージのダウンロードのみ行うため、インストールは不要です。</div>
</div>
<div class="line-block">
<div class="line">--downloaddir=&lt;ダウンロード先パス&gt;</div>
<div class="line">パッケージをダウンロードするディレクトリを指定します。</div>
<div class="line">通常のダウンロードと同様に、ローカルにあるパッケージと依存関係を解決しつつダウンロードされるため、</div>
<div class="line">該当パッケージがすでにインストールされている場合は不足分のみダウンロードされます。</div>
</div>
<div class="line-block">
<div class="line">--installroot=&lt;ダウンロード先絶対パス&gt;</div>
<div class="line">通常とは別の場所へインストールするために利用します。</div>
<div class="line">インストール済みのパッケージも含めてすべてダウンロードするため</div>
<div class="line">ダミーディレクトリを指定し、すべての パッケージをダウンロードします。</div>
</div>
<div class="line-block">
<div class="line">--releasever=&lt;バージョン&gt;</div>
<div class="line">ディストリビューションのバージョンを指定(9.4など)します。</div>
</div>
</div>
<div class="line-block">
<div class="line">createrepoをインストールします。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id57">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id57" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>createrepo
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">ローカルリポジトリを作成します。</div>
<div class="line">オフライン環境ではインターネット上のリポジトリサーバーを参照できないため、dnfによるパッケージのインストールができません。</div>
<div class="line">ローカルリポジトリにパッケージを追加することで、dnfによるパッケージインストールが可能となります。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id58">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id58" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>createrepo<span class="w"> </span>/tmp/podman-repo
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">RPMパッケージを受け渡し用のディレクトリに格納します。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id59">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id59" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="nb">cd</span><span class="w"> </span>/tmp
<span class="linenos">2</span>cp<span class="w"> </span>-irp<span class="w"> </span>/tmp/podman-repo<span class="w"> </span>&lt;受け渡し用ディレクトリ&gt;
<span class="linenos">3</span><span class="c1">#/mnt/mainte/exastro/rhel9/podmanを受け渡し用ディレクトリとする場合</span>
<span class="linenos">4</span>cp<span class="w"> </span>-irp<span class="w"> </span>/tmp/podman-repo<span class="w"> </span>/mnt/mainte/exastro/rhel9/podman
</pre></div>
</div>
</div>
</div></div>
</section>
</section>
<section id="exastro">
<h3>Exastroリソースのダウンロード<a class="headerlink" href="#exastro" title="この見出しへのパーマリンク">¶</a></h3>
<section id="id17">
<h4>Exastroリソースをダウンロードする<a class="headerlink" href="#id17" title="この見出しへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">docker-compose版Exastroのリソースをダウンロードします。</div>
</div>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-ZG9ja2Vy" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-1-ZG9ja2Vy" name="ZG9ja2Vy" role="tab" tabindex="0">docker</button><button aria-controls="panel-1-cG9kbWFu" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-1-cG9kbWFu" name="cG9kbWFu" role="tab" tabindex="-1">podman</button></div><div aria-labelledby="tab-1-ZG9ja2Vy" class="sphinx-tabs-panel group-tab" id="panel-1-ZG9ja2Vy" name="ZG9ja2Vy" role="tabpanel" tabindex="0"><div class="literal-block-wrapper docutils container" id="id60">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id60" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="nb">cd</span><span class="w"> </span>/tmp
<span class="linenos">2</span>curl<span class="w"> </span>-OL<span class="w"> </span>https://github.com/exastro-suite/exastro-docker-compose/archive/main.zip
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">ダウンロードしたExastroリソースを受け渡し用ディレクトリに格納します。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id61">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id61" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>unzip<span class="w"> </span>main.zip<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>mv<span class="w"> </span>exastro-docker-compose-main<span class="w"> </span>exastro-docker-compose
<span class="linenos">2</span><span class="c1">#受け渡し用ディレクトリを/mnt/mainte/exastro/almalinux/dockerとする場合</span>
<span class="linenos">3</span>cp<span class="w"> </span>-irp<span class="w"> </span>/tmp/exastro-docker-compose<span class="w">  </span>/mnt/mainte/exastro/almalinux/docker
</pre></div>
</div>
</div>
</div><div aria-labelledby="tab-1-cG9kbWFu" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-1-cG9kbWFu" name="cG9kbWFu" role="tabpanel" tabindex="0"><div class="literal-block-wrapper docutils container" id="id62">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id62" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="nb">cd</span><span class="w"> </span>/tmp
<span class="linenos">2</span>curl<span class="w"> </span>-OL<span class="w"> </span>https://github.com/exastro-suite/exastro-docker-compose/archive/main.zip
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">ダウンロードしたExastroリソースを受け渡し用ディレクトリに格納します。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id63">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id63" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>unzip<span class="w"> </span>main.zip<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>mv<span class="w"> </span>exastro-docker-compose-main<span class="w"> </span>exastro-docker-compose
<span class="linenos">2</span><span class="c1">#受け渡し用ディレクトリを/mnt/mainte/exastro/rhel9/podmanとする場合</span>
<span class="linenos">3</span>cp<span class="w"> </span>-irp<span class="w"> </span>/tmp/exastro-docker-compose<span class="w">  </span>/mnt/mainte/exastro/rhel9/podman
</pre></div>
</div>
</div>
</div></div>
</section>
</section>
</section>
<section id="id18">
<h2>オフライン環境(インターネットに接続できない環境)での作業<a class="headerlink" href="#id18" title="この見出しへのパーマリンク">¶</a></h2>
<div class="line-block">
<div class="line">オンライン環境での作業完了後、オフライン環境にて下記の手順を実施します。</div>
</div>
<section id="id19">
<h3>マウントの設定<a class="headerlink" href="#id19" title="この見出しへのパーマリンク">¶</a></h3>
<section id="id20">
<h4>設定ファイルを開く<a class="headerlink" href="#id20" title="この見出しへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">下記を順に実行し、資材受け渡し用のマウント設定を行います。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id64">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id64" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>sudo<span class="w"> </span>su<span class="w"> </span>-
<span class="linenos">2</span>vi<span class="w"> </span>/etc/fstab
</pre></div>
</div>
</div>
</section>
<section id="id21">
<h4>マウント設定を記述する<a class="headerlink" href="#id21" title="この見出しへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">viエディタで開いた/etc/fstabに下記のマウント設定を追記します。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id65">
<div class="code-block-caption"><span class="caption-text">記載例</span><a class="headerlink" href="#id65" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>/dev/sda1<span class="w"> </span>/mnt/mainte<span class="w"> </span>nfs<span class="w"> </span>defaults<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>
</pre></div>
</div>
</div>
</section>
<section id="id22">
<h4>設定を反映し、マウントを行う<a class="headerlink" href="#id22" title="この見出しへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">下記を順に実行し、設定を反映します。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id66">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id66" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>mkdir<span class="w"> </span>/mnt/mainte
<span class="linenos">2</span>systemctl<span class="w"> </span>daemon-reload
<span class="linenos">3</span>mount<span class="w"> </span>-a
<span class="linenos">4</span>df
<span class="linenos">5</span><span class="nb">exit</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="docker-compose-linux-x86-64">
<h3>docker-compose-linux-x86_64の取得<a class="headerlink" href="#docker-compose-linux-x86-64" title="この見出しへのパーマリンク">¶</a></h3>
<section id="id23">
<h4>docker-compose-linux-x86_64を取得する<a class="headerlink" href="#id23" title="この見出しへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">事前に取得したdocker-compose-linux-x86_64を下記ディレクトリに格納し、パーミッションを変更します。</div>
<div class="line">格納先 /usr/local/bin/docker-compose</div>
</div>
<div class="literal-block-wrapper docutils container" id="id67">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id67" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>chmod<span class="w"> </span>a+x<span class="w"> </span>/usr/local/bin/docker-compose
</pre></div>
</div>
</div>
</section>
</section>
<section id="id24">
<h3>RPMパッケージのインストール<a class="headerlink" href="#id24" title="この見出しへのパーマリンク">¶</a></h3>
<section id="id25">
<h4>RPMパッケージを取得する<a class="headerlink" href="#id25" title="この見出しへのパーマリンク">¶</a></h4>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-2-ZG9ja2Vy" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-2-ZG9ja2Vy" name="ZG9ja2Vy" role="tab" tabindex="0">docker</button><button aria-controls="panel-2-cG9kbWFu" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-2-cG9kbWFu" name="cG9kbWFu" role="tab" tabindex="-1">podman</button></div><div aria-labelledby="tab-2-ZG9ja2Vy" class="sphinx-tabs-panel group-tab" id="panel-2-ZG9ja2Vy" name="ZG9ja2Vy" role="tabpanel" tabindex="0"><div class="literal-block-wrapper docutils container" id="id68">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id68" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="nb">cd</span><span class="w"> </span>/tmp
<span class="linenos">2</span>cp<span class="w"> </span>-irp<span class="w"> </span>/mnt/mainte/exastro/almalinux/docker/docker-repo-almalinux<span class="w"> </span>.
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">ローカルリポジトリの設定ファイルを作成します。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id69">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id69" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>touch<span class="w"> </span>/etc/yum.repos.d/docker-repo-almalinux.repo
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">作成した設定ファイルに下記の情報を記載します。(※file: の後ろのスラッシュは3つ)</div>
</div>
<div class="literal-block-wrapper docutils container" id="id70">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id70" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>vi<span class="w"> </span>/etc/yum.repos.d/docker-repo-almalinux.repo

<span class="o">[</span>docker-repo-almalinux<span class="o">]</span>
<span class="nv">name</span><span class="o">=</span>RedHat-<span class="nv">$releaserver</span><span class="w"> </span>-<span class="w"> </span>docker
<span class="nv">baseurl</span><span class="o">=</span>file:///tmp/docker-repo-almalinux
<span class="nv">enabled</span><span class="o">=</span><span class="m">1</span>
<span class="nv">gpgcheck</span><span class="o">=</span><span class="m">0</span>
<span class="nv">gpgkey</span><span class="o">=</span>file:///etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">docker-repo-almalinuxのstatusがenabledになっていることを確認します。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id71">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id71" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>dnf<span class="w"> </span>repolist<span class="w"> </span>all
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">パッケージをインストールします。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id72">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id72" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>dnf<span class="w"> </span>-y<span class="w"> </span>--disablerepo<span class="o">=</span><span class="se">\*</span><span class="w"> </span>--enablerepo<span class="o">=</span>docker-repo-almalinux<span class="w"> </span>install<span class="w"> </span>git
</pre></div>
</div>
</div>
</div><div aria-labelledby="tab-2-cG9kbWFu" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-2-cG9kbWFu" name="cG9kbWFu" role="tabpanel" tabindex="0"><div class="literal-block-wrapper docutils container" id="id73">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id73" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="nb">cd</span><span class="w"> </span>/tmp
<span class="linenos">2</span>cp<span class="w"> </span>-irp<span class="w"> </span>/mnt/mainte/exastro/rhel9/podman/podman-repo<span class="w"> </span>.
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">ローカルリポジトリの設定ファイルを作成します。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id74">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id74" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>touch<span class="w"> </span>/etc/yum.repos.d/podman-repo.repo
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">作成した設定ファイルに下記の情報を記載します。(※file: の後ろのスラッシュは3つ)</div>
</div>
<div class="literal-block-wrapper docutils container" id="id75">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id75" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>vi<span class="w"> </span>/etc/yum.repos.d/podman-repo.repo

<span class="o">[</span>podman-repo<span class="o">]</span>
<span class="nv">name</span><span class="o">=</span>RedHat-<span class="nv">$releaserver</span><span class="w"> </span>-<span class="w"> </span>podman
<span class="nv">baseurl</span><span class="o">=</span>file:///tmp/podman-repo
<span class="nv">enabled</span><span class="o">=</span><span class="m">1</span>
<span class="nv">gpgcheck</span><span class="o">=</span><span class="m">0</span>
<span class="nv">gpgkey</span><span class="o">=</span>file:///etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">podman-repoのstatusがenabledになっていることを確認します。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id76">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id76" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>dnf<span class="w"> </span>repolist<span class="w"> </span>all
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">パッケージをインストールします。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id77">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id77" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>dnf<span class="w"> </span>-y<span class="w"> </span>--disablerepo<span class="o">=</span><span class="se">\*</span><span class="w"> </span>--enablerepo<span class="o">=</span>podman-repo<span class="w"> </span>install<span class="w"> </span>git
sudo<span class="w"> </span>dnf<span class="w"> </span>-y<span class="w"> </span>--disablerepo<span class="o">=</span><span class="se">\*</span><span class="w"> </span>--enablerepo<span class="o">=</span>podman-repo<span class="w"> </span>install<span class="w"> </span>podman
sudo<span class="w"> </span>dnf<span class="w"> </span>-y<span class="w"> </span>--disablerepo<span class="o">=</span><span class="se">\*</span><span class="w"> </span>--enablerepo<span class="o">=</span>podman-repo<span class="w"> </span>install<span class="w"> </span>podman-docker
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">依存関係によるエラー(conflicting recuests)が起きた場合は、対象のパッケージを削除します。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id78">
<div class="code-block-caption"><span class="caption-text">selinux-policyが原因の場合</span><a class="headerlink" href="#id78" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>dnf<span class="w"> </span>remove<span class="w"> </span>-y<span class="w"> </span>selinux-policy
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id79">
<div class="code-block-caption"><span class="caption-text">エラーメッセージ参考例</span><a class="headerlink" href="#id79" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>Error:
Problem:<span class="w"> </span>package<span class="w"> </span>podman-3:4.6.1-8.module+el8.9.0+21243+a586538b.x86_64<span class="w"> </span>requires<span class="w"> </span><span class="o">(</span>container-selinux<span class="w"> </span><span class="k">if</span><span class="w"> </span>selinux-policy<span class="o">)</span>,<span class="w"> </span>but<span class="w"> </span>none<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>providers<span class="w"> </span>can<span class="w"> </span>be<span class="w"> </span>installed
<span class="w"> </span>-<span class="w"> </span>conflicting<span class="w"> </span>requests
<span class="w"> </span>-<span class="w"> </span>problem<span class="w"> </span>with<span class="w"> </span>installed<span class="w"> </span>package<span class="w"> </span>selinux-policy-3.14.3-67.el8.noarch
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">エラーの原因となった手順を再実行します。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id80">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id80" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>sudo<span class="w"> </span>dnf<span class="w"> </span>-y<span class="w"> </span>--disablerepo<span class="o">=</span><span class="se">\*</span><span class="w"> </span>--enablerepo<span class="o">=</span>podman-repo<span class="w"> </span>install<span class="w"> </span>パッケージ名
<span class="linenos">2</span><span class="c1">#podmanをインストールする際に依存関係のエラーが起きた場合</span>
<span class="linenos">3</span>sudo<span class="w"> </span>dnf<span class="w"> </span>-y<span class="w"> </span>--disablerepo<span class="o">=</span><span class="se">\*</span><span class="w"> </span>--enablerepo<span class="o">=</span>podman-repo<span class="w"> </span>install<span class="w"> </span>podman
</pre></div>
</div>
</div>
</div></div>
</section>
</section>
<section id="id26">
<h3>コンテナイメージの実行<a class="headerlink" href="#id26" title="この見出しへのパーマリンク">¶</a></h3>
<section id="id27">
<h4>シェルスクリプトを作成する<a class="headerlink" href="#id27" title="この見出しへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">コンテナイメージを実行するシェルスクリプトを作成します。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id81">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id81" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="nb">cd</span><span class="w"> </span>/mnt/mainte/exastro/container-images
<span class="linenos">2</span>touch<span class="w"> </span>load.sh
<span class="linenos">3</span>vi<span class="w"> </span>load.sh
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id82">
<div class="code-block-caption"><span class="caption-text">下記のコードをコピー＆ペースト</span><a class="headerlink" href="#id82" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nv">ITA_VERSION</span><span class="o">=</span><span class="nv">$1</span>
<span class="nb">declare</span><span class="w"> </span>-A<span class="w"> </span><span class="nv">PF_VERSION</span><span class="o">=(</span>
<span class="w">  </span><span class="o">[</span><span class="s2">&quot;2.2.0&quot;</span><span class="o">]=</span><span class="s2">&quot;1.6.0&quot;</span>
<span class="w">  </span><span class="o">[</span><span class="s2">&quot;2.2.1&quot;</span><span class="o">]=</span><span class="s2">&quot;1.6.0&quot;</span>
<span class="w">  </span><span class="o">[</span><span class="s2">&quot;2.3.0&quot;</span><span class="o">]=</span><span class="s2">&quot;1.7.0&quot;</span>
<span class="w">  </span><span class="o">[</span><span class="s2">&quot;2.4.0&quot;</span><span class="o">]=</span><span class="s2">&quot;1.8.0&quot;</span>
<span class="w">  </span><span class="o">[</span><span class="s2">&quot;alpha.2499a9.20240328-232349&quot;</span><span class="o">]=</span><span class="s2">&quot;alpha.d718ac.20240325-152726&quot;</span>
<span class="w">  </span><span class="o">[</span><span class="s2">&quot;alpha.03f9ca.20240406-214252&quot;</span><span class="o">]=</span><span class="s2">&quot;alpha.d718ac.20240325-152726&quot;</span>
<span class="o">)</span>

readarray<span class="w"> </span>-t<span class="w"> </span>image_list<span class="w"> </span>&lt;<span class="w"> </span><span class="s2">&quot;./image.list&quot;</span>
<span class="k">for</span><span class="w"> </span>image<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="si">${</span><span class="nv">image_list</span><span class="p">[@]</span><span class="si">}</span>
<span class="k">do</span>
<span class="w">  </span><span class="nv">image_fullname</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span><span class="w"> </span><span class="si">${</span><span class="nv">image</span><span class="si">}</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;s/#__ITA_VERSION__#/</span><span class="si">${</span><span class="nv">ITA_VERSION</span><span class="si">}</span><span class="s2">/&quot;</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;s/#__PF_VERSION__#/</span><span class="si">${</span><span class="nv">PF_VERSION</span><span class="p">[</span><span class="nv">$ITA_VERSION</span><span class="p">]</span><span class="si">}</span><span class="s2">/&quot;</span><span class="k">)</span>
<span class="w">  </span><span class="nv">image_name</span><span class="o">=</span><span class="k">$(</span>basename<span class="w"> </span><span class="si">${</span><span class="nv">image_fullname</span><span class="si">}</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;s/:/-/&quot;</span><span class="k">)</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-e<span class="w"> </span><span class="si">${</span><span class="nv">ITA_VERSION</span><span class="si">}</span>/<span class="si">${</span><span class="nv">image_name</span><span class="si">}</span>.tar.gz<span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span>docker<span class="w"> </span>load<span class="w"> </span>&lt;<span class="w"> </span><span class="si">${</span><span class="nv">ITA_VERSION</span><span class="si">}</span>/<span class="si">${</span><span class="nv">image_name</span><span class="si">}</span>.tar.gz<span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">    </span>docker<span class="w"> </span>tag<span class="w"> </span><span class="si">${</span><span class="nv">image_fullname</span><span class="p">/docker.io/localhost</span><span class="si">}</span><span class="w"> </span><span class="si">${</span><span class="nv">image_fullname</span><span class="si">}</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">    </span>docker<span class="w"> </span>rmi<span class="w"> </span><span class="si">${</span><span class="nv">image_fullname</span><span class="p">/docker.io/localhost</span><span class="si">}</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">  </span><span class="k">fi</span>
<span class="k">done</span>

<span class="nb">wait</span>
</pre></div>
</div>
</div>
</section>
<section id="id28">
<h4>シェルスクリプトを実行する<a class="headerlink" href="#id28" title="この見出しへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">コンテナイメージを実行します。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id83">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id83" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sh<span class="w"> </span>./load.sh<span class="w"> </span><span class="m">2</span>.4.0
</pre></div>
</div>
</div>
</section>
</section>
<section id="id29">
<h3>Exastroリソースのインストール<a class="headerlink" href="#id29" title="この見出しへのパーマリンク">¶</a></h3>
<section id="id30">
<h4>Exastroリソースを取得する<a class="headerlink" href="#id30" title="この見出しへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">docker-compose版Exastroのリソースを、一般ユーザーのホームディレクトリ直下に格納します。</div>
<div class="line">エラーが起きた際の対応については後述します。</div>
</div>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-3-ZG9ja2Vy" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-3-ZG9ja2Vy" name="ZG9ja2Vy" role="tab" tabindex="0">docker</button><button aria-controls="panel-3-cG9kbWFu" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-3-cG9kbWFu" name="cG9kbWFu" role="tab" tabindex="-1">podman</button></div><div aria-labelledby="tab-3-ZG9ja2Vy" class="sphinx-tabs-panel group-tab" id="panel-3-ZG9ja2Vy" name="ZG9ja2Vy" role="tabpanel" tabindex="0"><div class="literal-block-wrapper docutils container" id="id84">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id84" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1">#一般ユーザーのホームディレクトリを/home/testuser、受け渡し用ディレクトリを/mnt/mainte/exastro/almalinux/dockerとする場合</span>
<span class="linenos">2</span><span class="nb">cd</span><span class="w">  </span>/home/testuser
<span class="linenos">3</span>cp<span class="w"> </span>-irp<span class="w"> </span>/mnt/mainte/exastro/almalinux/docker/exastro-docker-compose<span class="w"> </span>.
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">Exastro ServiceのパッケージとExastro source fileのインストールを行います。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id85">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id85" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>~/exastro-docker-compose<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>sh<span class="w"> </span>./setup.sh<span class="w"> </span>install<span class="w"> </span>-i
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<div class="line-block">
<div class="line">各オプションの説明</div>
</div>
<div class="line-block">
<div class="line">-i, --install-packages</div>
<div class="line">Only install required packages and fetch exastro source files</div>
</div>
<div class="line-block">
<div class="line">-e, --setup</div>
<div class="line">Only generate environment file (.env)</div>
</div>
<div class="line-block">
<div class="line">-r, --regist-service</div>
<div class="line">Only install exastro service</div>
</div>
<div class="line-block">
<div class="line">-c, --check</div>
<div class="line-block">
<div class="line">Check if your system meets the system requirements</div>
</div>
</div>
</div>
<div class="line-block">
<div class="line">必要なパッケージなどのインストールが完了すると下記のように対話形式で設定値を投入することが可能です。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id86">
<div class="code-block-caption"><span class="caption-text">Exastro Serviceのセットアップ</span><a class="headerlink" href="#id86" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>~/exastro-docker-compose<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>sh<span class="w"> </span>./setup.sh<span class="w"> </span>install<span class="w"> </span>-e
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id87">
<div class="code-block-caption"><span class="caption-text">OASE コンテナデプロイ要否の確認</span><a class="headerlink" href="#id87" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>Deploy<span class="w"> </span>OASE<span class="w"> </span>container<span class="w"> </span>?<span class="w"> </span><span class="o">(</span>y/n<span class="o">)</span><span class="w"> </span><span class="o">[</span>default:<span class="w"> </span>y<span class="o">]</span>:
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id88">
<div class="code-block-caption"><span class="caption-text">Gitlab コンテナデプロイ要否の確認</span><a class="headerlink" href="#id88" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>Deploy<span class="w"> </span>Gitlab<span class="w"> </span>containser?<span class="w"> </span><span class="o">(</span>y/n<span class="o">)</span><span class="w"> </span><span class="o">[</span>default:<span class="w"> </span>n<span class="o">]</span>:
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id89">
<div class="code-block-caption"><span class="caption-text">Exastro サービスのURL</span><a class="headerlink" href="#id89" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>Input<span class="w"> </span>the<span class="w"> </span>Exastro<span class="w"> </span>service<span class="w"> </span>URL?<span class="w">  </span><span class="o">[</span>default:<span class="w"> </span>http://127.0.0.1:30080<span class="o">]</span>:<span class="w"> </span>http://ita.example.com:30080
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id90">
<div class="code-block-caption"><span class="caption-text">Exastro 管理用サービスのURL</span><a class="headerlink" href="#id90" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>Input<span class="w"> </span>the<span class="w"> </span>Exastro<span class="w"> </span>management<span class="w"> </span>URL?<span class="w">       </span><span class="o">[</span>default:<span class="w"> </span>http://127.0.0.1:30081<span class="o">]</span>:<span class="w"> </span>http://ita.example.com:30081
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id91">
<div class="code-block-caption"><span class="caption-text">Gitlab コンテナのURL(Gitlab コンテナをデプロイする場合は入力が必要です。)</span><a class="headerlink" href="#id91" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>Input<span class="w"> </span>the<span class="w"> </span>external<span class="w"> </span>URL<span class="w"> </span>of<span class="w"> </span>Gitlab<span class="w"> </span>container<span class="w">  </span><span class="o">[</span>default:<span class="w"> </span><span class="o">(</span>nothing<span class="o">)]</span>:
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id92">
<div class="code-block-caption"><span class="caption-text">設定ファイルの生成の確認</span><a class="headerlink" href="#id92" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>System<span class="w"> </span>parametes<span class="w"> </span>are<span class="w"> </span>bellow.

System<span class="w"> </span>administrator<span class="w"> </span>password:<span class="w">    </span>********
Database<span class="w"> </span>password:<span class="w">                </span>********
OASE<span class="w"> </span>deployment<span class="w">                   </span><span class="nb">true</span>
MongoDB<span class="w"> </span>password<span class="w">                  </span>********
Service<span class="w"> </span>URL:<span class="w">                      </span>http://ita.example.com:30080
Manegement<span class="w"> </span>URL:<span class="w">                   </span>http://ita.example.com:30081
Docker<span class="w"> </span>GID:<span class="w">                       </span><span class="m">985</span>
Docker<span class="w"> </span>Socket<span class="w"> </span>path:<span class="w">               </span>/var/run/docker.sock
GitLab<span class="w"> </span>deployment:<span class="w">                </span><span class="nb">false</span>

Generate<span class="w"> </span>.env<span class="w"> </span>file<span class="w"> </span>with<span class="w"> </span>these<span class="w"> </span>settings?<span class="w"> </span><span class="o">(</span>y/n<span class="o">)</span><span class="w"> </span><span class="o">[</span>default:<span class="w"> </span>n<span class="o">]</span>
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">セットアップ完了後、Exastro Serviceのインストールを実行します。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id93">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id93" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>~/exastro-docker-compose<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>sh<span class="w"> </span>./setup.sh<span class="w"> </span>install<span class="w"> </span>-r
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">/var/run/docker.sockのパーミッションを変更します。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id94">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id94" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>chmod<span class="w"> </span><span class="m">666</span><span class="w"> </span>/var/run/docker.sock
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">Exastro Serviceを起動します。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id95">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id95" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>~/exastro-docker-compose<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>docker-compose<span class="w"> </span>up<span class="w"> </span>-d
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">詳細な設定を編集する場合は、<strong class="command">n</strong> もしくは <strong class="command">no</strong> と入力し、以降の処理をスキップします。</div>
<div class="line">そのまま Exastro システムのコンテナ群を起動する場合は、<strong class="command">y</strong> もしくは <strong class="command">yes</strong> と入力します。</div>
<div class="line">Exastro システムのデプロイには数分～数十分程度の時間が掛かります。(通信環境やサーバースペックによって状況は異なります。)</div>
</div>
</div><div aria-labelledby="tab-3-cG9kbWFu" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-3-cG9kbWFu" name="cG9kbWFu" role="tabpanel" tabindex="0"><div class="literal-block-wrapper docutils container" id="id96">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id96" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1">#一般ユーザーのホームディレクトリを/home/testuser、受け渡し用ディレクトリを/mnt/mainte/exastro/rhel9/podmanとする場合</span>
<span class="linenos">2</span><span class="nb">cd</span><span class="w">  </span>/home/testuser
<span class="linenos">3</span>cp<span class="w"> </span>-irp<span class="w"> </span>/mnt/mainte/exastro/rhel9/podman/exastro-docker-compose<span class="w"> </span>.
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">SELinuxの動作モードを変更します。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id97">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id97" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>sudo<span class="w"> </span>vi<span class="w"> </span>/etc/selinux/config
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id98">
<div class="code-block-caption"><span class="caption-text">/etc/selinux/config記載例</span><a class="headerlink" href="#id98" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="c1"># This file controls the state of SELinux on the system.</span>
<span class="c1"># SELINUX= can take one of these three values:</span>
<span class="c1">#     enforcing - SELinux security policy is enforced.</span>
<span class="c1">#     permissive - SELinux prints warnings instead of enforcing.</span>
<span class="c1">#     disabled - No SELinux policy is loaded.</span>
<span class="c1"># See also:</span>
<span class="c1"># https://docs.fedoraproject.org/en-US/quick-docs/getting-started-with-selinux/#getting-started-with-selinux-selinux-states-and-modes</span>
<span class="c1">#</span>
<span class="c1"># NOTE: In earlier Fedora kernel builds, SELINUX=disabled would also</span>
<span class="c1"># fully disable SELinux during boot. If you need a system with SELinux</span>
<span class="c1"># fully disabled instead of SELinux running with no policy loaded, you</span>
<span class="c1"># need to pass selinux=0 to the kernel command line. You can use grubby</span>
<span class="c1"># to persistently set the bootloader to boot with selinux=0:</span>
<span class="c1">#</span>
<span class="c1">#    grubby --update-kernel ALL --args selinux=0</span>
<span class="c1">#</span>
<span class="c1"># To revert back to SELinux enabled:</span>
<span class="c1">#</span>
<span class="c1">#    grubby --update-kernel ALL --remove-args selinux</span>
<span class="c1">#</span>
<span class="nv">SELINUX</span><span class="o">=</span>permissive
<span class="c1"># SELINUXTYPE= can take one of these three values:</span>
<span class="c1">#     targeted - Targeted processes are protected,</span>
<span class="c1">#     minimum - Modification of targeted policy. Only selected processes are protected.</span>
<span class="c1">#     mls - Multi Level Security protection.</span>
<span class="nv">SELINUXTYPE</span><span class="o">=</span>targeted
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id99">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id99" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>reboot
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">再度オフライン環境に接続し、SELinuxの動作モードがPermissiveになっていることを確認します。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id100">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id100" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>getenforce
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">Exastro ServiceのパッケージとExastro source fileのインストールを行います。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id101">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id101" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>~/exastro-docker-compose<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>sh<span class="w"> </span>./setup.sh<span class="w"> </span>install<span class="w"> </span>-i
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<div class="line-block">
<div class="line">各オプションの説明</div>
</div>
<div class="line-block">
<div class="line">-i, --install-packages</div>
<div class="line">Only install required packages and fetch exastro source files</div>
</div>
<div class="line-block">
<div class="line">-e, --setup</div>
<div class="line">Only generate environment file (.env)</div>
</div>
<div class="line-block">
<div class="line">-r, --regist-service</div>
<div class="line">Only install exastro service</div>
</div>
<div class="line-block">
<div class="line">-c, --check</div>
<div class="line-block">
<div class="line">Check if your system meets the system requirements</div>
</div>
</div>
</div>
<div class="line-block">
<div class="line">必要なパッケージなどのインストールが完了すると下記のように対話形式で設定値を投入することが可能です。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id102">
<div class="code-block-caption"><span class="caption-text">Exastro Serviceのセットアップ</span><a class="headerlink" href="#id102" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>~/exastro-docker-compose<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>sh<span class="w"> </span>./setup.sh<span class="w"> </span>install
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id103">
<div class="code-block-caption"><span class="caption-text">OASE コンテナデプロイ要否の確認</span><a class="headerlink" href="#id103" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>Deploy<span class="w"> </span>OASE<span class="w"> </span>container<span class="w"> </span>URL?<span class="w"> </span><span class="o">(</span>y/n<span class="o">)</span><span class="w"> </span><span class="o">[</span>default:<span class="w"> </span>y<span class="o">]</span>:
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id104">
<div class="code-block-caption"><span class="caption-text">Gitlab コンテナデプロイ要否の確認(Gitlab コンテナをデプロイする場合は入力が必要です。)</span><a class="headerlink" href="#id104" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>Deploy<span class="w"> </span>Gitlab<span class="w"> </span>containser?<span class="w"> </span><span class="o">(</span>y/n<span class="o">)</span><span class="w"> </span><span class="o">[</span>default:<span class="w"> </span>n<span class="o">]</span>:
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id105">
<div class="code-block-caption"><span class="caption-text">Exastro サービスのURL</span><a class="headerlink" href="#id105" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>Input<span class="w"> </span>the<span class="w"> </span>Exastro<span class="w"> </span>service<span class="w"> </span>URL?<span class="w">  </span><span class="o">[</span>default:<span class="w"> </span>http://127.0.0.1:30080<span class="o">]</span>:<span class="w"> </span>http://ita.example.com:30080
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id106">
<div class="code-block-caption"><span class="caption-text">Exastro 管理用サービスのURL</span><a class="headerlink" href="#id106" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>Input<span class="w"> </span>the<span class="w"> </span>Exastro<span class="w"> </span>management<span class="w"> </span>URL?<span class="w">       </span><span class="o">[</span>default:<span class="w"> </span>http://127.0.0.1:30081<span class="o">]</span>:<span class="w"> </span>http://ita.example.com:30081
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id107">
<div class="code-block-caption"><span class="caption-text">GitLab コンテナデプロイ要否の確認</span><a class="headerlink" href="#id107" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>Input<span class="w"> </span>the<span class="w"> </span>external<span class="w"> </span>URL<span class="w"> </span>of<span class="w"> </span>Gitlab<span class="w"> </span>container<span class="w">  </span><span class="o">[</span>default:<span class="w"> </span><span class="o">(</span>nothing<span class="o">)]</span>:
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id108">
<div class="code-block-caption"><span class="caption-text">設定ファイルの生成の確認</span><a class="headerlink" href="#id108" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>System<span class="w"> </span>parametes<span class="w"> </span>are<span class="w"> </span>bellow.

System<span class="w"> </span>administrator<span class="w"> </span>password:<span class="w">    </span>********
Database<span class="w"> </span>password:<span class="w">                </span>********
OASE<span class="w"> </span>deployment<span class="w">                   </span><span class="nb">true</span>
MongoDB<span class="w"> </span>password<span class="w">                  </span>********
Service<span class="w"> </span>URL:<span class="w">                      </span>http://ita.example.com:30080
Manegement<span class="w"> </span>URL:<span class="w">                   </span>http://ita.example.com:30081
Docker<span class="w"> </span>GID:<span class="w">                       </span><span class="m">1000</span>
Docker<span class="w"> </span>Socket<span class="w"> </span>path:<span class="w">               </span>/run/user/1000/podman/podman.sock
GitLab<span class="w"> </span>deployment:<span class="w">                </span><span class="nb">false</span>

Generate<span class="w"> </span>.env<span class="w"> </span>file<span class="w"> </span>with<span class="w"> </span>these<span class="w"> </span>settings?<span class="w"> </span><span class="o">(</span>y/n<span class="o">)</span><span class="w"> </span><span class="o">[</span>default:<span class="w"> </span>n<span class="o">]</span>
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">セットアップ完了後、Exastro Serviceのインストールを実行します。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id109">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id109" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>~/exastro-docker-compose<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>sh<span class="w"> </span>./setup.sh<span class="w"> </span>install<span class="w"> </span>-r
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">/var/run/docker.sockのパーミッションを変更します。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id110">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id110" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>chmod<span class="w"> </span><span class="m">666</span><span class="w"> </span>/var/run/docker.sock
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">Exastro Serviceを起動します。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id111">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id111" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>~/exastro-docker-compose<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>docker-compose<span class="w"> </span>up<span class="w"> </span>-d
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">詳細な設定を編集する場合は、<strong class="command">n</strong> もしくは <strong class="command">no</strong> と入力し、以降の処理をスキップします。</div>
<div class="line">そのまま Exastro システムのコンテナ群を起動する場合は、<strong class="command">y</strong> もしくは <strong class="command">yes</strong> と入力します。</div>
<div class="line">Exastro システムのデプロイには数分～数十分程度の時間が掛かります。(通信環境やサーバースペックによって状況は異なります。)</div>
</div>
</div></div>
</section>
</section>
<section id="id31">
<h3>エラー対応<a class="headerlink" href="#id31" title="この見出しへのパーマリンク">¶</a></h3>
<section id="id32">
<h4>エラー対応<a class="headerlink" href="#id32" title="この見出しへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">Exastroのインストール時にエラーが起きた際の対応についてです。</div>
</div>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-4-ZG9ja2Vy" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-4-ZG9ja2Vy" name="ZG9ja2Vy" role="tab" tabindex="0">docker</button><button aria-controls="panel-4-cG9kbWFu" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-4-cG9kbWFu" name="cG9kbWFu" role="tab" tabindex="-1">podman</button></div><div aria-labelledby="tab-4-ZG9ja2Vy" class="sphinx-tabs-panel group-tab" id="panel-4-ZG9ja2Vy" name="ZG9ja2Vy" role="tabpanel" tabindex="0"><div class="line-block">
<div class="line">setup.sh実行時に発生する可能性のあるエラーと対処方法です。</div>
<div class="line">下記エラーはインストール済みパッケージ(container-selinux)のバージョンが原因で発生したものです。</div>
<div class="line">rpm -q パッケージ名 で対象パッケージのバージョンを確認し、オンライン環境とオフライン環境でそれぞれの手順を実行します。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id112">
<div class="code-block-caption"><span class="caption-text">エラーメッセージ</span><a class="headerlink" href="#id112" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>Error:
Problem<span class="w"> </span><span class="m">1</span>:<span class="w"> </span>cannot<span class="w"> </span>install<span class="w"> </span>the<span class="w"> </span>best<span class="w"> </span>candidate<span class="w"> </span><span class="k">for</span><span class="w"> </span>the<span class="w"> </span>job
<span class="w"> </span>-<span class="w"> </span>nothing<span class="w"> </span>provides<span class="w"> </span>container-selinux<span class="w"> </span>&gt;<span class="o">=</span><span class="w"> </span><span class="m">2</span>:2.74<span class="w"> </span>needed<span class="w"> </span>by<span class="w"> </span>docker-ce-3:26.1.0-1.el8.x86_64<span class="w"> </span>from<span class="w"> </span>docker-ce-stable
Problem<span class="w"> </span><span class="m">2</span>:<span class="w"> </span>cannot<span class="w"> </span>install<span class="w"> </span>the<span class="w"> </span>best<span class="w"> </span>candidate<span class="w"> </span><span class="k">for</span><span class="w"> </span>the<span class="w"> </span>job
<span class="w"> </span>-<span class="w"> </span>nothing<span class="w"> </span>provides<span class="w"> </span>container-selinux<span class="w"> </span>&gt;<span class="o">=</span><span class="w"> </span><span class="m">2</span>:2.74<span class="w"> </span>needed<span class="w"> </span>by<span class="w"> </span>containerd.io-1.6.31-3.1.el8.x86_64<span class="w"> </span>from<span class="w"> </span>docker-ce-stable
<span class="o">(</span>try<span class="w"> </span>to<span class="w"> </span>add<span class="w"> </span><span class="s1">&#39;--skip-broken&#39;</span><span class="w"> </span>to<span class="w"> </span>skip<span class="w"> </span>uninstallable<span class="w"> </span>packages<span class="w"> </span>or<span class="w"> </span><span class="s1">&#39;--nobest&#39;</span><span class="w"> </span>to<span class="w"> </span>use<span class="w"> </span>not<span class="w"> </span>only<span class="w"> </span>best<span class="w"> </span>candidate<span class="w"> </span>packages<span class="o">)</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id113">
<div class="code-block-caption"><span class="caption-text">オンライン環境での手順</span><a class="headerlink" href="#id113" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--downloadonly<span class="w"> </span>--downloaddir<span class="o">=</span>/tmp/docker-repo-almalinux<span class="w"> </span>--installroot<span class="o">=</span>/tmp/docker-installroot-almalinux<span class="w"> </span>--releasever<span class="o">=</span><span class="m">8</span>.9<span class="w"> </span>container-selinux
<span class="linenos">2</span>createrepo<span class="w"> </span>--update<span class="w"> </span>/tmp/docker-repo-almalinux
<span class="linenos">3</span><span class="nb">cd</span><span class="w"> </span>/tmp
<span class="linenos">4</span>cp<span class="w"> </span>-irp<span class="w"> </span>/tmp/docker-repo-almalinux<span class="w"> </span>/mnt/mainte/exastro/almalinux/docker
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id114">
<div class="code-block-caption"><span class="caption-text">オフライン環境での手順</span><a class="headerlink" href="#id114" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="nb">cd</span><span class="w"> </span>/tmp
<span class="linenos">2</span>cp<span class="w"> </span>-irp<span class="w"> </span>/mnt/mainte/exastro/almalinux/docker/docker-repo-almalinux<span class="w"> </span>.
<span class="linenos">3</span>sudo<span class="w"> </span>dnf<span class="w"> </span>-y<span class="w"> </span>--disablerepo<span class="o">=</span><span class="se">\*</span><span class="w"> </span>--enablerepo<span class="o">=</span>docker-repo-almalinux<span class="w"> </span>install<span class="w"> </span>container-selinux
</pre></div>
</div>
</div>
</div><div aria-labelledby="tab-4-cG9kbWFu" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-4-cG9kbWFu" name="cG9kbWFu" role="tabpanel" tabindex="0"><div class="line-block">
<div class="line">Exastroインストール時に発生する可能性のあるエラーと対処方法です。</div>
<div class="line">下記エラーはSELinuxの動作モードが原因で発生したものです。</div>
<div class="line">オフライン環境にて下記手順を実行し、SELinuxの動作モードをPermissiveに変更します。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id115">
<div class="code-block-caption"><span class="caption-text">エラーメッセージ</span><a class="headerlink" href="#id115" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>ERROR<span class="o">]</span>:<span class="w"> </span>In<span class="w"> </span>Rootless<span class="w"> </span>Podman<span class="w"> </span>environment,<span class="w"> </span>SELinux<span class="w"> </span>only<span class="w"> </span>supports<span class="w"> </span>Permissive<span class="w"> </span>mode.
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id116">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id116" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>sudo<span class="w"> </span>vi<span class="w"> </span>/etc/selinux/config
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id117">
<div class="code-block-caption"><span class="caption-text">/etc/selinux/config記載例</span><a class="headerlink" href="#id117" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="c1"># This file controls the state of SELinux on the system.</span>
<span class="c1"># SELINUX= can take one of these three values:</span>
<span class="c1">#     enforcing - SELinux security policy is enforced.</span>
<span class="c1">#     permissive - SELinux prints warnings instead of enforcing.</span>
<span class="c1">#     disabled - No SELinux policy is loaded.</span>
<span class="c1"># See also:</span>
<span class="c1"># https://docs.fedoraproject.org/en-US/quick-docs/getting-started-with-selinux/#getting-started-with-selinux-selinux-states-and-modes</span>
<span class="c1">#</span>
<span class="c1"># NOTE: In earlier Fedora kernel builds, SELINUX=disabled would also</span>
<span class="c1"># fully disable SELinux during boot. If you need a system with SELinux</span>
<span class="c1"># fully disabled instead of SELinux running with no policy loaded, you</span>
<span class="c1"># need to pass selinux=0 to the kernel command line. You can use grubby</span>
<span class="c1"># to persistently set the bootloader to boot with selinux=0:</span>
<span class="c1">#</span>
<span class="c1">#    grubby --update-kernel ALL --args selinux=0</span>
<span class="c1">#</span>
<span class="c1"># To revert back to SELinux enabled:</span>
<span class="c1">#</span>
<span class="c1">#    grubby --update-kernel ALL --remove-args selinux</span>
<span class="c1">#</span>
<span class="nv">SELINUX</span><span class="o">=</span>permissive
<span class="c1"># SELINUXTYPE= can take one of these three values:</span>
<span class="c1">#     targeted - Targeted processes are protected,</span>
<span class="c1">#     minimum - Modification of targeted policy. Only selected processes are protected.</span>
<span class="c1">#     mls - Multi Level Security protection.</span>
<span class="nv">SELINUXTYPE</span><span class="o">=</span>targeted
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id118">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id118" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>reboot
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">再度オフライン環境に接続します。</div>
<div class="line">SELinuxの動作モードがPermissiveになっていることを確認し、エラーとなった手順を再度実行します。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id119">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id119" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>getenforce
</pre></div>
</div>
</div>
</div></div>
</section>
</section>
</section>
<section id="id33">
<h2>ログイン<a class="headerlink" href="#id33" title="この見出しへのパーマリンク">¶</a></h2>
<div class="line-block">
<div class="line">ログインに使用するユーザ名とパスワードの確認方法です。</div>
</div>
<div class="literal-block-wrapper docutils container" id="id120">
<div class="code-block-caption"><span class="caption-text">コマンド</span><a class="headerlink" href="#id120" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="nb">cd</span><span class="w"> </span>~/exastro-docker-compose
<span class="linenos">2</span>cat<span class="w"> </span>.env
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id121">
<div class="code-block-caption"><span class="caption-text">ログイン情報</span><a class="headerlink" href="#id121" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1">### Initial account information for creating system administrators</span>
<span class="linenos">2</span><span class="c1">#### Specify the username and password</span>
<span class="linenos">3</span><span class="c1"># SYSTEM_ADMIN=&lt;ユーザー名&gt;</span>
<span class="linenos">4</span><span class="nv">SYSTEM_ADMIN_PASSWORD</span><span class="o">=</span>&lt;パスワード&gt;
</pre></div>
</div>
</div>
</section>
<section id="id34">
<h2>オーガナイゼーションの作成<a class="headerlink" href="#id34" title="この見出しへのパーマリンク">¶</a></h2>
<div class="line-block">
<div class="line">再起動後に再度ログインをしたら、オーガナイゼーションの作成を行います。</div>
<div class="line">オーガナイゼーションの詳細については、 <a class="reference internal" href="../manuals/platform_management/organization.html"><span class="doc">Organization (オーガナイゼーション)</span></a> を参照してください。</div>
</div>
</section>
<section id="id35">
<h2>ワークスペースの作成<a class="headerlink" href="#id35" title="この見出しへのパーマリンク">¶</a></h2>
<div class="line-block">
<div class="line">作成したオーガナイゼーションにログインをしたら、ワークスペースを作成する必要があります。</div>
<div class="line">ワークスペースの作成については、<a class="reference internal" href="../manuals/organization_management/workspace.html"><span class="doc">Workspace (ワークスペース)</span></a> を参照してください。</div>
</div>
</section>
</section>


</div>


<div id="articleNavigation">
  <ul>
  </ul>
</div>


<div id="pageTopLink">
  <a href="#container"><i>↑</i> Page Top</a>
</div>

</article>
</div>
</main>
</div><!-- End #contents -->
<div id="footer">
  <footer class="divInner">
    <small>Copyright © 2019-2023 NEC Corporation</small>
    <small><a href="/terms/ja.html">サイト規約</a></small>
  </footer>
</div><!-- End #footer -->

<div id="overlay"></div>
<div id="grayBack"></div>

</div><!-- End #container -->
  </body>
</html>